
:imagesdir: ../images/

= Docker Guide

This is a guide on how to use Docker (particularly: Docker Compose). It shows different options on how to execute docker-compose on an instruction file (a docker-compose.yml). 

This guide assumes you already have Docker installed and set up. If not, see <<../general_guidelines/Getting-Docker.adoc#, Setting Up Docker For Asciidoc>> first.

If you are looking for the default docker-compose.yml for projects, see the <<StandardDockerConfig.adoc,default docker-compose.yml for creating local htmls>>.

== Dockerfile vs. Docker Compose

Docker is the software that lets you work with images and containers. It uses dockerfiles and docker-compose.ymls to specify instructions on what to build and satrt. The following gives a short overview over their differences in use and function.

NOTE: These definitions have been taken from https://dockerlabs.collabnix.com/beginners/difference-compose-dockerfile.html.

Dockerfile:: A Dockerfile is a simple text file that contains the commands a user could call to assemble an image.

Docker Compose:: Docker Compose is a tool for defining and running multi-container Docker applications in an isolated environment. It uses a docker-compose.yml file that contains the instructions for creating said environment and the services to use.

Your Docker workflow should be to build a suitable Dockerfile for each image you wish to create, then use compose to assemble the images using the build command.

**If you only use pre-defined images, you can skip the use of Dockerfiles and only write a docker-compose.yml for the image(s) you need to use.**

== Using Docker In ASAM Projects

To reduce the need for local software installation, ASAM proposes to use docker and suitable docker images for things like Asciidoctor and Antora, particularly when wanting to build something locally instead of through the ASAM build pipeline. The following sections give an overview over how to run Docker Compose on a docker-compose.yml.

See also:

* <<../writing_guidelines/Docker-For-Asciidco.adoc#,Using Docker for Asciidoctor>>

IMPORTANT: `docker-compose` must be executed in the folder where the relevant docker-compose.yml file is located!

=== Running Docker Compose From VSCode

IMPORTANT: The docker deamon must be running in the background before you can run docker commands from VSCode. To start the deamon, either have Docker Desktop automatically start with Windows or start it manually.

You can run Docker-Compose directly from within Visual Studio Code if you have added the docker extensions. VSCode will automatically ask you if it finds a .yml file in your project workspace. Otherwise, you can get it through the usual way of finding and installing extensions:

include::Recommended-VSCode-Extensions.adoc[tag=docker-extension]

To run Docker-Compose on your docker-compose.yml, right-click on the file in your workspace and select `Compose Up` from the menu.

image::ComposeUp.png[title=Run "Compose Up" from the context menu]

=== Running Docker Compose From Powershell

IMPORTANT: The docker deamon must be running in the background before you can run docker commands from the powershell. To start the deamon, either have Docker Desktop automatically start with Windows or start it manually.

You can run docker commands from the Windows powershell or the cmd tool.

image::DockerFromPS.gif[title="Run Docker-Compose from Powershell"]

. Navigate to the folder with your docker-compose.yml
. Type `docker-compose run asciidoctor` and confirm with Enter

=== Starting A Container From Docker Desktop

NOTE: This works if the container was already created through either using the <<Running Docker-Compose From VSCode,VSCode method>> or the <<Running Docker-Compose From Powershell,Powershell method>>.

. Open Docker Desktop (if you already started it, it may be in the system tray)
. Go to "Containers/Apps" and select your container from the list
. Click the image:play-button-docker.png[alt=Play] button to run the container

== See Also
* link:https://docs.docker.com/get-started/[Official guide for Docker]
* <<../general_guidelines/Getting-Docker.adoc, Setting Up Docker For Asciidoc>>
* <<StandardDockerConfig.adoc,Default docker-compose.yml>>


IMPORTANT: Before running docker from VSCode, make sure to start Docker Desktop (and, thereby, the docker deamon).

